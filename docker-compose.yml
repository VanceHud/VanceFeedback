version: '3.8'

services:
  vance-feedback:
    build: .
    ports:
      - "${PORT:-3000}:3000"
    restart: always
    environment:
      # Application Configuration
      - PORT=3000
      - JWT_SECRET=${JWT_SECRET}

      # Database Configuration
      # Default: SQLite (no extra config needed, uses /app/server/data/feedback.db)

      # Optional: MySQL Configuration (Uncomment to use)
      # - DB_TYPE=mysql
      # - DB_HOST=host.docker.internal
      # - DB_PORT=3306
      # - DB_USER=root
      # - DB_PASS=password
      # - DB_NAME=vancefeedback

      # Auto-Installer Configuration (Runs on first start if DB is empty)
      - ADMIN_USER=${ADMIN_USER:-admin}
      - ADMIN_PASS=${ADMIN_PASS:-admin123}

    volumes:
      # Persist SQLite data
      - ./server/data:/app/server/data
      # Persist Configuration
      - ./server/config:/app/server/config
    networks:
      - vance-network

networks:
  vance-network:
    driver: bridge
